{% extends "layout.html" %}

{% block additional_js %}
<link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.15.5/dist/bootstrap-table.min.css">

{% endblock additional_js %}

{% block content %}
<div class="bd-example">

    <div class="input-group">
       <select class="custom-select col-lg-3" id="header_selector">
        <option selected >Search All field</option>
          {% for Project_header in Project_headers%}
            <option value="{{ Project_header }}">{{ Project_header }}</option>
          {% endfor %}
      </select>
      <input type="text" class="form-control " placeholder="type search item" aria-label="search box" aria-describedby="basic-addon2" id = "search_text"">
      <div class="input-group-append">
        <button class="btn btn-outline-secondary" type="button">search</button>
      </div>
    </div>
    <table class="table table-striped table-hover table-sm" id = "Smart_listing_table">
      <thead>
        <tr class ="thead-dark">
          {% for Project_header in Project_headers%}
            <th  scope="col" id ="{{Project_header}}" value="{{Project_header}}" >
                {{ Project_header }}
<!--                <i class="fa fa-sort" style="font-size:13px;"></i>-->
            </th>
          {% endfor %}
        </tr>
      </thead>
      <tbody id="Smart_listing_table_body">
        {% for Project_items_row in Project_items%}
            <tr>
                {% for Project_header in Project_headers %}
                        <td scope="row">{{ Project_items_row.__dict__.get(Project_header)}}</td>
                    {% else %}
                        <td scope="row">{{ Project_items_row.__dict__.get(Project_header)}}</td>
                {% endfor %}
            </tr>
        {% endfor %}
      </tbody>

    </table>
</div>
{% endblock content %}
{% block add_on_js %}


<script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap4.min.js"></script>


<script>
    $("#Smart_listing_table").DataTable(


    );
</script>
<script>
    $(document).ready(function(){
          $("#search_text").on("keyup", function() {
            var value = $(this).val().toLowerCase();
            var header_value = $("#header_selector").val();
            $("#Smart_listing_table_body tr").filter(function() {
                if($("#header_selector").val() ==  "Search All field" ){
                     $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1);

                }
                else {
                        var i ,tr , header_index
                        header_index = $( "#" + $("#header_selector").val()).index()
                        tr = $("tr")
                        for (i = 0; i < tr.length; i++) {
                        td = tr[i].getElementsByTagName("td")[header_index];
                        if (td) {
                          txtValue = td.textContent || td.innerText;
                          if (txtValue.toLowerCase().indexOf(value) > -1) {
                            tr[i].style.display = "";
                          } else {
                            tr[i].style.display = "none";
                          }
                        }
                       }
                   }
                });
          });
        });

</script>


{% endblock add_on_js %}