{% extends "layout.html" %}

{% block additional_js %}
<link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.15.5/dist/bootstrap-table.min.css">

{% endblock additional_js %}

{% block content %}
<div class="bd-example">
    <div class="input-group">
        <table class="table table-striped table-hover table-sm  data-sort-class" id = "Income_table">
          <thead>
            <tr class ="thead-dark">
                <th  scope="col" id ="Income" value="Income" > Income </th>
                <th  scope="col" id ="Current_fy" value="Current_fy" > Year Ended {{datetime.strptime(Current_Income_items [0].__dict__.get('year_end'),'%Y-%m-%d %H:%M:%S').strftime('%d/%m/%y')}}</th>
                <th  scope="col" id ="Last_fy" value="Last_fy" > Year Ended {{datetime.strptime(Previous_Income_items [-1].__dict__.get('year_end'),'%Y-%m-%d %H:%M:%S').strftime('%d/%m/%y')}}</th>
                <th scope="col" id ="variance" value="variance" >variance </th>
                <th scope="col" id ="Percentage" value="Percentage" >Percentage change</th>
            </tr>
          </thead>
          <tbody id="Income_table_body">
            {% for Current_Income_item,Previous_Income_item  in zip(Current_Income_items,Previous_Income_items ) %}



                <tr>
                    <td scope="row" ><a href="{{url_for('posts.income_expenditure_breakdown', audit_description = Current_Income_item.__dict__.get('audit_description'))}}">{{ Current_Income_item .__dict__.get('audit_description')}}</a></td>
                    <td class= "numbers" scope="row">{{ "%.0f" % (Current_Income_item .__dict__.get("amount") * -1)}}</td>
                    <td class= "numbers" scope="row">{{  Previous_Income_item .__dict__.get("amount") * -1  }}</td>
                    <td class= "numbers" scope="row">{{  Previous_Income_item .__dict__.get("amount") -  Current_Income_item .__dict__.get("amount") }}</td>
                    <td class= "numbers" scope="row">{{  "%.2f" % ((Previous_Income_item .__dict__.get("amount") -  Current_Income_item .__dict__.get("amount"))/ Previous_Income_item .__dict__.get("amount") * -100)}}</td>
                </tr>
            {% endfor %}
          </tbody>

        </table>
        <table class="table table-striped table-hover table-sm  data-sort-class float-left" id = "Expenditure_table">
          <thead>
            <tr class ="thead-dark">
                <th  scope="col" id ="Expenditure" value="Expenditure" > Expenditure </th>
                <th  scope="col" id ="Current_fy" value="Current_fy" > Year Ended {{datetime.strptime(Current_Expenditure_items [0].__dict__.get('year_end'),'%Y-%m-%d %H:%M:%S').strftime('%d/%m/%y')}}</th>
                <th  scope="col" id ="Last_fy" value="Last_fy" > Year Ended {{datetime.strptime(Previous_Expenditure_items [-1].__dict__.get('year_end'),'%Y-%m-%d %H:%M:%S').strftime('%d/%m/%y')}}</th>
                <th scope="col" id ="variance" value="variance" >variance </th>
                <th scope="col" id ="Percentage" value="Percentage" >Percentage change</th>

            </tr>
          </thead>
          <tbody id="Expenditure_table_body">
            {% for Current_Expenditure_item , Previous_Expenditure_item in zip(Current_Expenditure_items,Previous_Expenditure_items)  %}
                <tr>
                    <td scope="row"><a href="{{url_for('posts.income_expenditure_breakdown', audit_description =Current_Expenditure_item.__dict__.get('audit_description'))}}">{{ Current_Expenditure_item .__dict__.get('audit_description')}}</a></td>
                    <td class= "numbers" scope="row">{{  Current_Expenditure_item .__dict__.get("amount")}}</td>
                    <td class= "numbers" scope="row">{{  Previous_Expenditure_item .__dict__.get("amount") }}</td>
                    <td class= "numbers" scope="row">{{  Current_Expenditure_item.__dict__.get("amount") -  Previous_Expenditure_item.__dict__.get("amount") }}</td>
                    <td class= "numbers" scope="row">{{  "%.2f" % ((Previous_Expenditure_item .__dict__.get("amount") -  Current_Expenditure_item .__dict__.get("amount"))/ Previous_Expenditure_item .__dict__.get("amount") * -100)}}</td>
                </tr>
            {% endfor %}
          </tbody>

        </table>
    </div>
</div>
{% endblock content %}

{% block add_on_js %}


<script>
    $.fn.digits = function(){
    return this.each(function(){
        $(this).text( $(this).text().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,") );
    })
}

</script>
<script>
    $(".numbers").digits();
</script>

<script>
    $("#Income_table").DataTable({
        "paging":   false,
        "ordering": true,
        "info":     false
        }
    );
    $("#Expenditure_table").DataTable({
        "paging":   false,
        "ordering": true,
        "info":     false
        }
    );
</script>
{% endblock add_on_js %}